

#define s_size 50
#define st_size 100
#define ARRAY_ALLOC_FAIL NULL
#define INT_ALLOC_FAIL NULL
#define ARRAY_FULL -1
#define ARRAY_DEALLOC -2
#define INSERT_SUCCESS 1

typedef struct {
    char station_name[s_size];
    char station_code[s_size];
    char arrival[s_size];
    char departure[s_size];
    int distance;
    int halt;
    int platform;
} Station;

typedef struct {
    int train_no;
    char train_name[s_size];
    char train_type[s_size];

    Station st[st_size];  // Array of stations
    int st_count;
} Train;

typedef struct {
    Train *arr;        // Dynamic array
    int train_count;   // number of trains added
    int total_trains;  // allocated size
} TrainArray;

TrainArray * initialize(int size);
int insert_data(TrainArray * , Train data);
void search_by_train_no(TrainArray * , int no);

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "header1.h"

TrainArray * initialize(int size)
{
    TrainArray * t_arr;

    t_arr = (TrainArray *)malloc(sizeof(TrainArray));
    if(t_arr == NULL) return ARRAY_ALLOC_FAIL;

    t_arr->train_count = 0;
    t_arr->total_trains = size;
    t_arr->arr = (Train *)malloc(sizeof(Train) * size);

    if(t_arr->arr == NULL) {
        free(t_arr);
        return INT_ALLOC_FAIL;
    }
    return t_arr;
}

int insert_data(TrainArray * t_arr, Train data)
{
    if(t_arr == NULL) return ARRAY_DEALLOC;

    if(t_arr->train_count == t_arr->total_trains) return ARRAY_FULL;

    *(t_arr->arr + t_arr->train_count) = data;
    t_arr->train_count++;

    return INSERT_SUCCESS;
}
void search_by_train_no(TrainArray *t_arr, int no)
{
    for (int i = 0; i < t_arr->train_count; i++)
    {
        if (t_arr->arr[i].train_no == no)
        {
            printf("%d %s %s %d\n",
                   t_arr->arr[i].train_no,
                   t_arr->arr[i].train_name,
                   t_arr->arr[i].train_type,
                   t_arr->arr[i].st_count);
        }
    }
}



#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <assert.h>
#include "header1.h"

int main()
{
    TrainArray *db;
    Train t;

    // Initialize array of 5 trains
    db = initialize(5);
    assert(db != NULL);
    assert(db->train_count == 0);
    assert(db->total_trains == 5);


    t.train_no = 101;
    strcpy(t.train_name, "KonkanExpress");
    strcpy(t.train_type, "Express");

    t.st_count = 3;

    strcpy(t.st[0].station_name, "Mangalore");
    strcpy(t.st[0].station_code, "MAQ");
    strcpy(t.st[0].arrival, "-");
    strcpy(t.st[0].departure, "06:00");
    t.st[0].distance = 0;
    t.st[0].halt = 0;
    t.st[0].platform = 1;

    strcpy(t.st[1].station_name, "Udupi");
    strcpy(t.st[1].station_code, "UD");
    strcpy(t.st[1].arrival, "06:45");
    strcpy(t.st[1].departure, "06:47");
    t.st[1].distance = 60;
    t.st[1].halt = 2;
    t.st[1].platform = 2;

    strcpy(t.st[2].station_name, "Mumbai");
    strcpy(t.st[2].station_code, "MMCT");
    strcpy(t.st[2].arrival, "20:30");
    strcpy(t.st[2].departure, "-");
    t.st[2].distance = 900;
    t.st[2].halt = 0;
    t.st[2].platform = 4;

    assert(insert_data(db, t));
    assert(db->train_count == 1);

    strcpy(t.train_name, "Intercity");
    strcpy(t.train_type, "Superfast");

    t.st_count = 2;

    strcpy(t.st[0].station_name, "Udupi");
    strcpy(t.st[0].station_code, "UD");
    strcpy(t.st[0].arrival, "-");
    strcpy(t.st[0].departure, "07:00");
    t.st[0].distance = 0;
    t.st[0].halt = 0;
    t.st[0].platform = 2;

    strcpy(t.st[1].station_name, "Goa");
    strcpy(t.st[1].station_code, "GOA");
    strcpy(t.st[1].arrival, "12:00");
    strcpy(t.st[1].departure, "-");
    t.st[1].distance = 350;
    t.st[1].halt = 0;
    t.st[1].platform = 1;

    assert(insert_data(db, t));
    assert(db->train_count == 2);


    t.train_no = 103;
    strcpy(t.train_name, "MumbaiExpress");
    strcpy(t.train_type, "Express");

    t.st_count = 3;

    strcpy(t.st[0].station_name, "Goa");
    strcpy(t.st[0].station_code, "GOA");
    strcpy(t.st[0].arrival, "-");
    strcpy(t.st[0].departure, "06:00");
    t.st[0].distance = 0;
    t.st[0].halt = 0;
    t.st[0].platform = 1;

    strcpy(t.st[1].station_name, "Udupi");
    strcpy(t.st[1].station_code, "UD");
    strcpy(t.st[1].arrival, "11:00");
    strcpy(t.st[1].departure, "11:05");
    t.st[1].distance = 250;
    t.st[1].halt = 5;
    t.st[1].platform = 2;

    strcpy(t.st[2].station_name, "Mangalore");
    strcpy(t.st[2].station_code, "MAQ");
    strcpy(t.st[2].arrival, "12:30");
    strcpy(t.st[2].departure, "-");
    t.st[2].distance = 310;
    t.st[2].halt = 0;
    t.st[2].platform = 3;

    assert(insert_data(db, t));
    assert(db->train_count == 3);

    t.train_no = 104;
    strcpy(t.train_name, "JanShatabdi");
    strcpy(t.train_type, "Superfast");

    t.st_count = 2;

    strcpy(t.st[0].station_name, "Mangalore");
    strcpy(t.st[0].station_code, "MAQ");
    strcpy(t.st[0].arrival, "-");
    strcpy(t.st[0].departure, "14:00");
    t.st[0].distance = 0;
    t.st[0].halt = 0;
    t.st[0].platform = 1;

    strcpy(t.st[1].station_name, "Udupi");
    strcpy(t.st[1].station_code, "UD");
    strcpy(t.st[1].arrival, "14:45");
    strcpy(t.st[1].departure, "-");
    t.st[1].distance = 60;
    t.st[1].halt = 0;
    t.st[1].platform = 2;

    assert(insert_data(db, t));
    assert(db->train_count == 4);

    t.train_no = 105;
    strcpy(t.train_name, "GoaExpress");
    strcpy(t.train_type, "Express");

    t.st_count = 1;

    strcpy(t.st[0].station_name, "Goa");
    strcpy(t.st[0].station_code, "GOA");
    strcpy(t.st[0].arrival, "-");
    strcpy(t.st[0].departure, "-");
    t.st[0].distance = 0;
    t.st[0].halt = 0;
    t.st[0].platform = 1;

    assert(insert_data(db, t));
    assert(db->train_count == 5);

    t.train_no = 106;
    strcpy(t.train_name, "ExtraTrain");
    strcpy(t.train_type, "Express");
    t.st_count = 1;

    assert(insert_data(db, t) == ARRAY_FULL);
    assert(db->train_count == 5);

    search_by_train_no(db,101);



    return 0;
}
