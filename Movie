#define m_size 20
#define g_size 30
#define ARRAY_ALLOC_FAIL NULL
#define INT_ALLOC_FAIL NULL
#define ARRAY_DEALLOC -1
#define ARRAY_FULL 9
#define INSERT_SUCCESS 1
#define FOUND 1
#define NOT_FOUND 0


struct _movie_ 
{
	int movie_id;
	char movie_name[m_size];
	char genre[g_size];
	int rating;
	int year;
};
typedef struct _movie_ Movie ;
 
struct _array_ 
{
	Movie *arr;
	int total_movie , mov_number;

};
typedef struct _array_ Array ;


Array * initialize(int);
int insert_data(Array *, Movie data );
void search_by_year(Array *, int);
void search_by_rating(Array * , int);
void search_by_genre_and_rating(Array * , int , char *);
void sort_by_id(Array *);


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "header.h"

Array * initialize(int size)
{
    Array * my_arr;
    my_arr =(Array *)malloc(sizeof(Array));
    if(NULL == my_arr) return ARRAY_ALLOC_FAIL;

    (*my_arr).mov_number = 0;

    my_arr->total_movie= size;
    my_arr->arr = (Movie *)malloc(sizeof(Movie) * size);

    if(NULL == my_arr->arr){
        free(my_arr);
        return INT_ALLOC_FAIL;
    }
    return my_arr;
}

int insert_data(Array * my_arr, Movie data )
{
	if(my_arr == NULL) return ARRAY_DEALLOC;

    if(my_arr->mov_number == my_arr->total_movie) return ARRAY_FULL;
    
    *(my_arr->arr + my_arr->mov_number) = data;
    my_arr->mov_number++;
    
    return INSERT_SUCCESS;
    
}
void search_by_year(Array *my_arr, int yr)
{
for (int i = 0; i < my_arr->mov_number; i++) 
{
        if (my_arr->arr[i].year == yr) {
            printf("%d %s %s %d %d\n",
                   my_arr->arr[i].movie_id,
                   my_arr->arr[i].movie_name,
                   my_arr->arr[i].genre,
                   my_arr->arr[i].rating,
                   my_arr->arr[i].year);
}
}
}

void search_by_rating(Array * my_arr, int rat)
{
	for(int i=0; i < my_arr->mov_number; i++)
	{
		if(my_arr->arr[i].rating == rat ) 
		{
		    printf("%d %s %s %d %d \n",
                   my_arr->arr[i].movie_id,
                   my_arr->arr[i].movie_name,
                   my_arr->arr[i].genre,
                   my_arr->arr[i].rating,
                   my_arr->arr[i].year);
		}
	}
}	


void search_by_genre_and_rating(Array * my_arr, int rat ,char *gen)
{
	for(int i=0; i < my_arr->mov_number; i++)
	{
		if(my_arr->arr[i].rating > rat && //
			strcmp(my_arr->arr[i].genre , gen)==0)
		{
			
			printf("%d %s %s %d %d \n",
                   my_arr->arr[i].movie_id,
                   my_arr->arr[i].movie_name,
                   my_arr->arr[i].genre,
                   my_arr->arr[i].rating,
                   my_arr->arr[i].year);
		}
	}
}
void sort_by_id(Array * my_arr)
{
    int i,j;
    Movie temp;
    int flag;
    for(j=0;j<my_arr->mov_number-1;j++){
        flag=0;
    for(i=0;i<my_arr->mov_number-j-1;i++){
        if((my_arr->arr[i].year) > (my_arr->arr[i+1].year)){
            flag =1;
            temp = my_arr->arr[i];
            my_arr->arr[i] = my_arr->arr[i+1];
            my_arr->arr[i+1] = temp;

        }
    }
    if(flag ==0) return;
    }
}





#include <stdio.h>
#include <stdlib.h>
#include<string.h>
#include <assert.h>
#include "header.h"


int main()
{
    Array * test;
    Movie mov;
    test = initialize(5);
    assert(test != NULL);
    assert(test->mov_number == 0);
    assert(test->total_movie == 5);

    mov.movie_id = 1001;
    strcpy(mov.movie_name, "lokah");
    strcpy(mov.genre, "superhero");
    mov.rating= 9;
    mov.year = 2025;
    assert(insert_data(test, mov));

    assert(test->mov_number == 1);

    mov.movie_id = 1002;
    strcpy(mov.movie_name, "Memories");
    strcpy(mov.genre, "Triller");
    mov.rating= 10;
    mov.year = 2015;
    assert(insert_data(test, mov));

    mov.movie_id = 1003;
    strcpy(mov.movie_name, "Lucifer");
    strcpy(mov.genre, "Action");
    mov.rating= 8;
    mov.year = 2019;
    assert(insert_data(test, mov));

    mov.movie_id = 1004;
    strcpy(mov.movie_name, "Conjuring");
    strcpy(mov.genre, "Horror");
    mov.rating= 6;
    mov.year = 2025;
    assert(insert_data(test, mov));

    mov.movie_id = 1005;
    strcpy(mov.movie_name, "Avengers Endgame");
    strcpy(mov.genre, "superhero");
    mov.rating= 10;
    mov.year = 2019;
    assert(insert_data(test, mov));

    mov.movie_id = 1006;
    strcpy(mov.movie_name, "Avengers InfinityWar");
    strcpy(mov.genre, "superhero");
    mov.rating= 10;
    mov.year = 2018;
    assert(insert_data(test, mov) == ARRAY_FULL);

    assert(test->mov_number == 5);
    search_by_year(test, 2025);
    search_by_rating(test, 10);
   search_by_genre_and_rating(test , 8 ,"superhero");
   sort_by_id(test);









    return 0;
}
